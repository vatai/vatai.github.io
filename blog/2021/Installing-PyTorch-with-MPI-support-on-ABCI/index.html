<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd"> <html><body> <p>To get MPI backend for <a href="https://pytorch.org/docs/stable/distributed.html" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">torch distributed</code></a> working you need to recompile PyTorch.</p> <p>On ABCI to get this working, you need to load these modules (some of them might be not needed, I just grabbed a <code class="language-plaintext highlighter-rouge">modules.sh</code> file):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module load gcc/9.3.0
module load cuda/11.2/11.2.2
module load cudnn/8.1/8.1.1
module load nccl/2.8/2.8.4-1
module load openmpi/4.0.5
module load python/3.8/3.8.7
module load cmake/3.19
</code></pre></div></div> <p>After this we just need to clone the PyTorch repo:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:pytorch/pytorch.git
</code></pre></div></div> <p>and build it:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 setup.py develop --user
</code></pre></div></div> <p>This <strong>overwrites</strong> your current PyTorch installation, and you need to use <code class="language-plaintext highlighter-rouge">--upgrade --forece-reinstall</code> with <code class="language-plaintext highlighter-rouge">pip3</code> to install the original one.</p> </body></html>